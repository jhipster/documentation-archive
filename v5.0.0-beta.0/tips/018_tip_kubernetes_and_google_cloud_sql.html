<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#353d47">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#353d47">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-status-bar-style" content="#353d47">
    <title>Kubernetes and Google Cloud SQL</title>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet" type="text/css">

    <!-- CSS Libs -->
    <link rel="stylesheet" type="text/css" href="/lib/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/lib/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/lib/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/lib/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="/lib/css/dataTables.bootstrap.css">
    <!-- CSS App -->
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/themes/flat-blue.css">
    
    <!-- Bootstrap Docs CSS subset to get icon -->
    <!--<link href="/css/bootstrap-docs.css" rel="stylesheet">-->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Favicon with QHD -->
    <link rel="icon" type="image/png" href="/images/logo/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/images/logo/favicon-16x16.png" sizes="16x16" />
<meta name="robots" content="noindex">
</head>

<body class="flat-blue">
    <div class="app-container expanded ">
        <div class="row content-container">
            <nav class="navbar navbar-inverse navbar-fixed-top navbar-top">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-expand-toggle fa-rotate-90">
                            <i class="fa fa-bars icon"></i>
                        </button>
                        <ol class="breadcrumb navbar-breadcrumb">
                            <li class="active"></li>
                        </ol>
                        <button type="button" class="navbar-right-expand-toggle pull-right visible-xs">
                            <i class="fa fa-th icon"></i>
                        </button>
                    </div>
                    <ul class="nav navbar-nav navbar-right">
                        
                        
                        <li class="page-scroll">
                            <a href="/documentation-archive/v5.0.0-beta.0/sponsors/">Sponsor</a>
                        </li>
                        
                        <li class="">
                            <a href="https://www.google.com/search?q=site:www.jhipster.tech" target="_blank">Search</a>
                        </li>
                        <li>
                            <a href="https://github.com/jhipster/generator-jhipster" class="dropdown-toggle navlink" target="_blank" role="button"><i class="fa fa-github fa-2x"></i></a>
                        </li>
                        <li>
                            <button type="button" class="navbar-right-expand-toggle visible-xs pull-right light">
                                <i class="fa fa-times icon"></i>
                            </button>
                        </li>
                    </ul>

                </div>
            </nav>
            <div class="side-menu sidebar-inverse">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="side-menu-container">
                        <div class="navbar-header">
                            <a class="navbar-brand" href="/">
                                <div class="icon"><img src="/documentation-archive/v5.0.0-beta.0/images/logo/logo-jhipster.svg" height="50px"></div>
                                <div class="title brand">JHipster </div>
                            </a>
                            <button type="button" class="navbar-expand-toggle pull-right visible-xs">
                                <i class="fa fa-times icon"></i>
                            </button>
                        </div>
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="/">
                                    <span class="icon fa fa-home"></span><span class="title">Home</span>
                                </a>
                            </li>
                            <li >
                                <a href="/documentation-archive/v5.0.0-beta.0/releases/">
                                    <span class="icon fa fa-file-text-o"></span><span class="title">Release notes</span>
                                </a>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-1">
                                    <span class="icon fa fa-road"></span><span class="title">JHipster in a few minutes</span>
                                </a>
                                <!-- Dropdown level 1 -->
                                <div id="dropdown-1" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/tech-stack/"><i class="fa fa-fw fa-stack-overflow"></i> Technology stack</a></li>
                                            <li ><a href="/presentation" target="_blank"><i class="fa fa-fw fa-desktop"></i> Official JHipster slides</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/screenshots/"><i class="fa fa-fw fa-picture-o"></i> JHipster in 5 screenshots</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/video-tutorial/"><i class="fa fa-fw fa-film"></i> Video tutorial (12 minutes)</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/companies-using-jhipster/"><i class="fa fa-fw fa-thumbs-up"></i> Companies using JHipster</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/showcase/"><i class="fa fa-fw fa-file-image-o"></i> Showcase of JHipster apps</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-2">
                                    <span class="icon fa fa-handshake-o"></span><span class="title">Contributing</span>
                                </a>
                                <!-- Dropdown level 1 -->
                                <div id="dropdown-2" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/sponsors/"><i class="fa fa-fw fa-usd"></i> Financial sponsors</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/contributing-individuals/"><i class="fa fa-fw fa-keyboard-o"></i> Contributing individuals</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/contributing-companies/"><i class="fa fa-fw fa-building"></i> Contributing companies</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-3">
                                    <span class="icon fa fa-fw fa-wrench"></span><span class="title">Setting up your environment</span>
                                </a>
                                <!-- Dropdown level 1 -->
                                <div id="dropdown-3" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/installation/"><i class="fa fa-fw fa-cloud-download"></i> Installing JHipster</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/configuring-a-corporate-proxy/"><i class="fa fa-fw fa-exchange"></i> Configuring a proxy</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/configuring-ide/"><i class="fa fa-fw fa-keyboard-o"></i> Configuring your IDE</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/docker-compose/"><i class="fa fa-fw fa-music"></i> Docker Compose</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/shell-plugins/"><i class="fa fa-fw fa-terminal"></i> Shell Plugins</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-4"><span class="icon fa fa-fw fa-list-ol"></span><span class="title">Core JHipster tasks</span></a>
                                <div id="dropdown-4" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/creating-an-app/"><i class="fa fa-fw fa-rocket"></i> Creating an application</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/creating-an-entity/"><i class="fa fa-fw fa-bolt"></i> Creating an entity</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/creating-a-spring-controller/"><i class="fa fa-fw fa-bolt"></i> Creating a Spring controller</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/creating-a-spring-service/"><i class="fa fa-fw fa-bolt"></i> Creating a Spring service</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-dtos/"><i class="fa fa-fw fa-briefcase"></i> Creating DTOs</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/managing-relationships/"><i class="fa fa-fw fa-sitemap"></i> Managing relationships</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/installing-new-languages/"><i class="fa fa-fw fa-flag"></i> Internationalization</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/upgrading-an-application/"><i class="fa fa-fw fa-refresh"></i> Upgrading an application</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-5"><span class="icon fa fa-fw fa-sitemap"></span><span class="title">Microservices</span></a>
                                <div id="dropdown-5" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/microservices-architecture/"><i class="fa fa-fw fa-map-signs"></i> Overview</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/api-gateway/"><i class="fa fa-fw fa-exchange"></i> API Gateway</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/traefik/"><i class="fa fa-fw fa-exchange"></i> Traefik</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/jhipster-registry/"><i class="fa fa-fw  fa-dashboard"></i> JHipster Registry</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/consul/"><i class="fa fa-fw fa-bullseye"></i> Consul</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-uaa/"><i class="fa fa-fw fa-lock"></i> JHipster UAA</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/creating-microservices/"><i class="fa fa-fw fa-bolt"></i> Creating microservices</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/microservices-in-production/"><i class="fa fa-fw fa-cloud"></i> Microservices in production</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-6"><span class="icon fa fa-fw fa-puzzle-piece"></span><span class="title">Options</span></a>
                                <div id="dropdown-6" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/security/"><i class="fa fa-fw fa-lock"></i> Securing your app</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/entities-filtering/"><i class="fa fa-fw fa-filter"></i> Filtering your entities</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-elasticsearch/"><i class="fa fa-fw fa-search"></i> Using Elasticsearch</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-websockets/"><i class="fa fa-fw fa-envelope"></i> Using Websockets</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/doing-api-first-development/"><i class="fa fa-fw fa-file-text"></i> Doing API-First development</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-cache/"><i class="fa fa-fw fa-line-chart"></i> Using a cache</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-oracle/"><i class="fa fa-fw fa-database"></i> Using Oracle</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-mongodb/"><i class="fa fa-fw fa-leaf"></i> Using MongoDB</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-couchbase/"><i class="fa fa-fw fa-database"></i> Using Couchbase</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-cassandra/"><i class="fa fa-fw fa-eye"></i> Using Cassandra</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-kafka/"><i class="fa fa-fw fa-envelope"></i> Using Kafka</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-7"><span class="icon fa fa-fw fa-code"></span><span class="title">Development</span></a>
                                <div id="dropdown-7" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/development/"><i class="fa fa-fw fa-code"></i> Using in development</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/profiles/"><i class="fa fa-fw fa-group"></i> Managing profiles</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/common-application-properties/"><i class="fa fa-fw fa-flask"></i> Common application properties</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/separating-front-end-and-api/"><i class="fa fa-fw fa-unlink"></i> Separating front-end and API</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/managing-server-errors/"><i class="fa fa-fw fa-fire-extinguisher"></i> Managing server errors</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-angularjs/"><i class="fa fa-fw fa-html5"></i> Using AngularJS</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/using-angular/"><i class="fa fa-fw fa-html5"></i> Using Angular</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/customizing-bootstrap-3/"><i class="fa fa-fw fa-css3"></i> Customizing Bootstrap 3</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/customizing-bootstrap-4/"><i class="fa fa-fw fa-css3"></i> Customizing Bootstrap 4</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-8"><span class="icon fa fa-fw fa-umbrella"></span><span class="title">Test &amp; QA</span></a>
                                <div id="dropdown-8" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/running-tests/"><i class="fa fa-fw fa-shield"></i> Running tests</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/code-quality/"><i class="fa fa-fw fa-diamond"></i> Code quality</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/setting-up-ci/"><i class="fa fa-fw fa-stethoscope"></i> Continuous Integration</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-9"><span class="icon fa fa-fw fa-cloud"></span><span class="title">Production</span></a>
                                <div id="dropdown-9" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/production/"><i class="fa fa-fw fa-play-circle"></i> Using in production</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/monitoring/"><i class="fa fa-fw fa-line-chart"></i> Monitoring</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/docker-hub/"><i class="fa fa-fw fa-cloud-upload"></i> Docker Hub</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/cloudfoundry/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying to Cloud Foundry</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/heroku/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying to Heroku</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/kubernetes/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying to Kubernetes</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/openshift/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying to OpenShift</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/rancher/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying to Rancher</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/aws/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying to AWS</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/boxfuse/"><i class="fa fa-fw fa-cloud-upload"></i> Deploying with Boxfuse</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-10"><span class="icon fa fa-fw fa-cubes"></span><span class="title">Modules</span></a>
                                <div id="dropdown-10" class="panel-collapse collapse" style="height: 0px;">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/modules/marketplace/"><i class="fa fa-fw fa-shopping-cart"></i> Marketplace</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/modules/creating-a-module/"><i class="fa fa-fw fa-cube"></i> Creating a module</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-11"><span class="icon fa fa-fw fa-wrench"></span><span class="title">Tools</span></a>
                                <div id="dropdown-11" class="panel-collapse collapse" style="height: 0px;">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/jdl/"><i class="fa fa-fw fa-star"></i> JDL</a></li>
                                            <li><a href="https://start.jhipster.tech/jdl-studio/"><i class="fa fa-fw fa-terminal"></i> JDL Studio</a></li>
                                            <li >
                                                <a href="/documentation-archive/v5.0.0-beta.0/jhipster-ide/"><i class="fa fa-fw fa-object-group"></i> JHipster IDE</a></li>
                                            <li >
                                                <a href="/documentation-archive/v5.0.0-beta.0/jhipster-uml/"><i class="fa fa-fw fa-magic"></i> JHipster-UML</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>

                            <li class="panel panel-default dropdown">
                                <a data-toggle="collapse" href="#dropdown-12"><span class="icon fa fa-fw fa-question"></span><span class="title">Getting help</span></a>
                                <div id="dropdown-12" class="panel-collapse collapse" style="height: 0px;">
                                    <div class="panel-body">
                                        <ul class="nav navbar-nav">
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/help/"><i class="fa fa-fw fa-users"></i> Community help</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/consulting/"><i class="fa fa-fw fa-user-md"></i> Professional help</a></li>
                                            <li ><a href="/documentation-archive/v5.0.0-beta.0/training/"><i class="fa fa-fw fa-graduation-cap"></i> Training</a></li>
                                        </ul>
                                     </div>
                                </div>
                            </li>
                            <li ><a href="/documentation-archive/v5.0.0-beta.0/tips/"><span class="icon fa fa-fw fa-cogs"></span><span class="title">Tips'n tricks</span></a></li>
                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                </nav>
            </div>
            <!-- Main Content -->
            <div id="page-wrapper" class="container-fluid">
                <div class="side-body" id="page-top">
                    
                    <div class="row page-content-wrapper">
                        <div class="col-lg-12">
                            <h1 id="kubernetes-and-google-cloud-sql">Kubernetes and Google Cloud SQL</h1>

<p><strong>Tip submitted by <a href="https://github.com/bourdux">@bourdux</a></strong></p>

<p>While it is already easy to deploy a JHipster application to <a href="https://cloud.google.com/container-engine/">Google Container Engine</a>
using the <a href="/documentation-archive/v5.0.0-beta.0/kubernetes">Kubernetes sub-generator</a>, the default behaviour is to create a Google Compute
Engine VM for the database.</p>

<p>If you want to take it one step further and use a fully-managed MySQL instance, you can use <a href="https://cloud.google.com/sql/">Google Cloud SQL</a>.
It allows automated backups, maintenance, replication for high availability and nice scalability features.</p>

<p>In this tip/tutorial, I will show you how you can deploy a JHipster application on Google Cloud that will use a Google
Cloud SQL database as a MySQL backend. In order to simplify the process, we will use a monolithic application. We will
also use a Maven build since it is my favourite one :p</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>For this tutorial, you will need:</p>

<ul>
  <li>A Google Cloud Platform account. You can use a <a href="https://cloud.google.com/free-trial/">60 day free trial</a> with $300 worth of free credit</li>
  <li><a href="https://cloud.google.com/sdk/">Google Cloud SDK</a> since we will perform most of the operations from a terminal. I found the <a href="https://cloud.google.com/sdk/downloads#interactive">interactive installer</a> quite convenient</li>
  <li><a href="https://www.docker.com/products/overview">Docker</a></li>
  <li>A JHipster application using MySQL as production database</li>
</ul>

<h2 id="initialize-gcloud-and-kubectl">Initialize gcloud and kubectl</h2>

<p>First of all, if you never used <code class="highlighter-rouge">gcloud</code>, you need to initialize it with the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud init
</code></pre></div></div>

<p><code class="highlighter-rouge">gcloud</code> allows you to perform most the operations you could do from the Google Cloud Web console from the comfort of
your terminal. First of all, let’s install <code class="highlighter-rouge">kubectl</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud components install kubectl
</code></pre></div></div>

<p><code class="highlighter-rouge">kubectl</code> is a command line interface for running commands against Kubernetes clusters. You can also install it directly
from the <a href="http://kubernetes.io/docs/user-guide/prereqs/">Kubernetes website</a> but overall I found the gcloud installation
more convenient.</p>

<p>Now you need to create a google cloud project. For this purpose you will need to go through the web console, as gcloud
does not allow you to create projects from CLI (not yet as it is an alpha feature). Alternatively you can use the <a href="https://cloud.google.com/resource-manager/docs/creating-project">Resource
Manager API</a>.</p>

<ul>
  <li>Go to <a href="https://console.cloud.google.com">Google Cloud Platform Console</a></li>
  <li>Click <strong>Create Project</strong></li>
  <li>Pick a project name, click <strong>Create</strong> and note the project ID, and/or customize as you feel.</li>
</ul>

<p>For this tutorial, purpose I picked the name <code class="highlighter-rouge">jhipster-kubernetes-cloud-sql</code>.</p>

<p>Then you need to:</p>

<ul>
  <li>Enable <a href="https://console.cloud.google.com/billing">billing</a> on the project</li>
  <li>Enable <a href="https://console.cloud.google.com/projectselector/kubernetes/list">Container Engine API</a> on the project</li>
  <li>Enable <a href="https://console.cloud.google.com/apis/dashboard">API Manager</a> for Compute Engine, Cloud SQL and Container Engine</li>
  <li>Enable <a href="https://console.developers.google.com/apis/api/sqladmin/overview">Google Cloud SQL API</a></li>
</ul>

<p>Finally you need to tell <code class="highlighter-rouge">gcloud</code> on which project you are currently working:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud config set project jhipster-kubernetes-cloud-sql
</code></pre></div></div>

<p>You can also tell it where you want your instances to be created by default. I chose <code class="highlighter-rouge">europe-west1-b</code> since I am a cheap
European :)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud config set compute/zone europe-west1-b
</code></pre></div></div>

<h2 id="create-a-cloud-sql-instance">Create a Cloud SQL instance</h2>

<p>Then you need to create a Google Cloud SQL instance. You can do this via the web console, which is nice to get a good
understanding on the available options or once again you can use <code class="highlighter-rouge">gcloud</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud beta sql instances create jhipster-sqlcloud-db --region=europe-west1 --tier=db-f1-micro\
 --authorized-networks=`curl -s ifconfig.co` --backup-start-time=01:00 --enable-bin-log \
 --activation-policy=ALWAYS --storage-type=HDD --storage-size=10GB
</code></pre></div></div>

<p>With this command we create a SQL Cloud instance called <code class="highlighter-rouge">jhipster-sql-cloud-db</code> in the <code class="highlighter-rouge">europe-west1</code> region. We choose
the smallest machine type available. To see the full list of available tiers you can use <code class="highlighter-rouge">gcloud sql tiers list</code>. Then we
whitelist our own ip for access with <code class="highlighter-rouge">mysql</code> CLI, setup a backup time window starting from 1AM UTC, enable binary logging
so we can go back in time if something goes wrong with the application. Finally we set the machine to be always activated
(necessary as second generation machines are billed per use), set up a HDD storage (SSD is more performant but more
expensive) and set the storage size to the minimum size. Note: we need to use the beta gcloud client to create second
generation SQL instances.</p>

<p>You can check that your instance started with the following command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud sql instances list
NAME                   REGION        TIER         ADDRESS         STATUS
jhipster-sqlcloud-db  europe-west1  db-f1-micro  146.148.21.155  RUNNABLE
</code></pre></div></div>

<p>Since we whitelisted our IP address, we should be able to access to the DB instance with <code class="highlighter-rouge">mysql</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql --host=146.148.21.155 --user=root --password
...
mysql&gt;
</code></pre></div></div>

<p>Since we’re connected to the database let us create the application database and user. Since we will be using the
<a href="https://cloud.google.com/sql/docs/sql-proxy">Cloud SQL proxy</a> to connect the SQL instance from our application container,
the user hostname can be set to <code class="highlighter-rouge">cloudsqlproxy~%</code> if you want to only allow connections through the proxy. The application
name for this tutorial is <code class="highlighter-rouge">jhipsterGoogleCloudSql</code> so the database name should have the same name if we want to use the
configuration generated by JHipster.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; CREATE DATABASE jhipstergooglecloudsql;
Query OK, 1 row affected (0,03 sec)

mysql&gt; CREATE USER 'jhipster'@'cloudsqlproxy~%';
Query OK, 0 rows affected (0,01 sec)

mysql&gt; GRANT ALL PRIVILEGES ON jhipstergooglecloudsql.* TO 'jhipster'@'cloudsqlproxy~%';
Query OK, 0 rows affected (0,01 sec)

mysql&gt; FLUSH PRIVILEGES;
Query OK, 0 rows affected (0,02 sec)
</code></pre></div></div>

<p>Do not forget to change the database user to jhipster in <code class="highlighter-rouge">application-prod.yml</code></p>

<h2 id="create-a-container-cluster">Create a container cluster</h2>

<p>Let us create a container cluster using <a href="https://cloud.google.com/container-engine/docs/">GKE</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud container clusters create jhipster-sqlcloud-cluster --zone=europe-west1-b --machine-type=g1-small --num-nodes=1
</code></pre></div></div>

<p>For this tutorial, we will use only 1 small node. In production, you will want at least 3 nodes :)</p>

<p>Let us then get kubectl get proper credentials for this cluster</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud container clusters get-credentials jhipster-sqlcloud-cluster

Fetching cluster endpoint and auth data.
kubeconfig entry generated for jhipster-sqlcloud-cluster.
</code></pre></div></div>

<h2 id="building-and-pushing-the-docker-image">Building and pushing the docker image</h2>

<p>First of all run the <a href="/documentation-archive/v5.0.0-beta.0/kubernetes">Kubernetes sub-generator</a>. Reply to the questions as usual but let us
use Container engine by pushing our docker image on Google Cloud. To the question “What should we use for the base Docker
repository name?”, reply by <code class="highlighter-rouge">gcr.io/jhipster-kubernetes-cloud-sql</code>. Replace with your project ID. For the docker image push
command let us use <code class="highlighter-rouge">gcloud docker -- push</code> in order to push to the project container repository.</p>

<p>Build your image</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn package -Pprod dockerfile:build
</code></pre></div></div>

<p>Tag the image (replace with your jhipster application name). We use v1 as a tag to be able to easily deploy new versions
of the application or rollback if something goes horribly wrong.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker image tag jhipstergooglecloudsql gcr.io/jhipster-kubernetes-cloud-sql/jhipstergooglecloudsql:v1
</code></pre></div></div>

<p>You can then push the image to Google Container engine as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud docker -- push gcr.io/jhipster-kubernetes-cloud-sql/jhipstergooglecloudsql:v1
</code></pre></div></div>

<h2 id="get-the-credentials-and-register-them-with-kubernetes">Get the credentials and register them with Kubernetes</h2>

<p>In order to use the Cloud SQL proxy, we will have to create credentials for our application and to register them to
Kubernetes. The full process is available in the <a href="https://cloud.google.com/sql/docs/container-engine-connect">Cloud SQL container engine connection documentation</a>
but let me summarize the commands here.</p>

<p>Create a service account for your JHipster application</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud iam service-accounts create jhipster-application --display-name="JHipster application"
</code></pre></div></div>

<p>Get the full iam account name (email used to generate key)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud iam service-accounts list
NAME                                    EMAIL
JHipster application                    jhipster-application@jhipster-kubernetes-cloud-sql.iam.gserviceaccount.com
</code></pre></div></div>

<p>Give editor access to the project to the service account</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud projects add-iam-policy-binding jhipster-kubernetes-cloud-sql \
 --member serviceAccount:jhipster-application@jhipster-kubernetes-cloud-sql.iam.gserviceaccount.com \
 --role roles/editor
</code></pre></div></div>

<p>Create the key and store it in <code class="highlighter-rouge">jhipster-credentials.json</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud iam service-accounts keys create \
--iam-account jhipster-application@jhipster-kubernetes-cloud-sql.iam.gserviceaccount.com jhipster-credentials.json
</code></pre></div></div>

<p>We will use this key later when</p>

<p>Register the key with <code class="highlighter-rouge">kubectl</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl create secret generic cloudsql-oauth-credentials --from-file=credentials.json=jhipster-credentials.json
</code></pre></div></div>

<h2 id="modify-the-kubernetes-deployment-config">Modify the Kubernetes deployment config</h2>

<p>First of all you can delete the generated mysql deployment file since we are going with a Cloud SQL instance.</p>

<p>Then we need to change a few things in <code class="highlighter-rouge">jhipstergooglecloudsql-deployment.yml</code>. First of all the Spring data source URL
should be changed to localhost since we will be using a Cloud SQL proxy:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jdbc:mysql://localhost:3306/jhipstergooglecloudsql?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false
</code></pre></div></div>

<p>Then you can add the version number to the container image:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>image: gcr.io/jhipster-kubernetes-cloud-sql/jhipstergooglecloudsql:v1
</code></pre></div></div>

<p>Then we need to add an entry to deploy the cloud sql proxy with the sidecar pattern:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- image: b.gcr.io/cloudsql-docker/gce-proxy:1.05
  name: cloudsql-proxy
  command: ["/cloud_sql_proxy", "--dir=/cloudsql",
            "-instances=jhipster-kubernetes-cloud-sql:europe-west1:jhipster-sqlcloud-db=tcp:3306",
            "-credential_file=/secrets/cloudsql/credentials.json"]
  volumeMounts:
    - name: cloudsql-oauth-credentials
      mountPath: /secrets/cloudsql
      readOnly: true
    - name: ssl-certs
      mountPath: /etc/ssl/certs
</code></pre></div></div>

<p>As we may have noted, we also need to provide SSL certificates to communicate with Google API so we can connect to our
Cloud SQL instance.</p>

<p>And finally add the appropriate volumes:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>volumes:
  - name: cloudsql-oauth-credentials
    secret:
      secretName: cloudsql-oauth-credentials
  - name: ssl-certs
    hostPath:
      path: /etc/ssl/certs
</code></pre></div></div>

<p>The full deployment file should now look like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: jhipstergooglecloudsql
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: jhipstergooglecloudsql
    spec:
      containers:
      - name: jhipstergooglecloudsql
        image: gcr.io/jhipster-kubernetes-cloud-sql/jhipstergooglecloudsql:v1
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: prod
        - name: SPRING_DATASOURCE_URL
          value: jdbc:mysql://localhost:3306/jhipstergooglecloudsql?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false
        ports:
        - containerPort: 8080
      - image: b.gcr.io/cloudsql-docker/gce-proxy:1.05
        name: cloudsql-proxy
        command: ["/cloud_sql_proxy", "--dir=/cloudsql",
                  "-instances=jhipster-kubernetes-cloud-sql:europe-west1:jhipster-sqlcloud-db=tcp:3306",
                  "-credential_file=/secrets/cloudsql/credentials.json"]
        volumeMounts:
          - name: cloudsql-oauth-credentials
            mountPath: /secrets/cloudsql
            readOnly: true
          - name: ssl-certs
            mountPath: /etc/ssl/certs
      volumes:
        - name: cloudsql-oauth-credentials
          secret:
            secretName: cloudsql-oauth-credentials
        - name: ssl-certs
          hostPath:
            path: /etc/ssl/certs
</code></pre></div></div>

<p>You can then deploy the cluster with <code class="highlighter-rouge">kubectl apply</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply -f jhipstergooglecloudsql

deployment "jhipstergooglecloudsql" created
service "jhipstergooglecloudsql" created
</code></pre></div></div>

<p>Then you can get the external IP through <code class="highlighter-rouge">kubectl get services</code> and test your application</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get services jhipstergooglecloudsql
NAME                     CLUSTER-IP     EXTERNAL-IP     PORT(S)    AGE
jhipstergooglecloudsql   10.95.251.18   104.199.51.11   8080/TCP   1m
</code></pre></div></div>

                        </div>
                    </div>
                    <!-- /.row -->
                    

                    <!-- Footer -->
                    <footer class="text-center">
                        
                        <hr>
                        <div class="footer-logos">
                            <div class="container">
                                <div class="row">
                                    <div class="col-12">
                                        JHipster is sponsored by:
                                    </div>
                                    <!-- change to below commented line when adding more logos -->
                                    <!-- <div class="col-xs-12 col-sm-6 col-md-4"> -->
                                    <div class="col-md-offset-4 col-sm-12 col-md-4">
                                        <div class="thumbnail no-margin-bottom">
                                            <div class="logo-container">
                                                <a href="https://developer.okta.com/signup?utm_source=JHipster&utm_medium=logo&utm_campaign=Gold-Sponsor" target="_blank"><img src="/documentation-archive/v5.0.0-beta.0/images/open-collective/okta.png" width="320px" height="108px"></a>
                                            </div>
                                        </div>
                                    </div>
                                    <!--
                                    <div class="col-xs-12 col-sm-6 col-md-4">
                                        <div class="thumbnail no-margin-bottom">
                                            <div class="logo-container">
                                                <a href="https://developer.okta.com/signup?utm_source=JHipster&utm_medium=logo&utm_campaign=Gold-Sponsor" target="_blank"><img src="/documentation-archive/v5.0.0-beta.0/images/open-collective/okta.png" width="320px" height="108px"></a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-4">
                                        <div class="thumbnail no-margin-bottom">
                                            <div class="logo-container">
                                                <a href="https://developer.okta.com/signup?utm_source=JHipster&utm_medium=logo&utm_campaign=Gold-Sponsor" target="_blank"><img src="/documentation-archive/v5.0.0-beta.0/images/open-collective/okta.png" width="320px" height="108px"></a>
                                            </div>
                                        </div>
                                    </div>
                                    -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="footer-above">
                            <div class="container">
                                <div class="row">
                                    <div class="footer-col col-md-4">
                                        <div class="col-md-4 col-sm-12">
                                            <h5 class="text-left"><i class="fa fa-coffee fa-fw"></i> <a class="link" href="/documentation-archive/v5.0.0-beta.0/team/">Team</a></h5>
                                            <h5 class="text-left"><i class="fa fa-pencil fa-fw"></i> <a class="link" href="/documentation-archive/v5.0.0-beta.0/artwork/">Artwork</a></h5>
                                        </div>
                                        <div class="col-md-4 col-sm-12">
                                            <h5 class="text-left"><i class="fa fa-gavel fa-fw"></i> <a class="link" href="/documentation-archive/v5.0.0-beta.0/policies/">Policies</a></h5>
                                            <h5 class="text-left"><i class="fa fa-meetup fa-fw"></i> <a class="link" href="/documentation-archive/v5.0.0-beta.0/meetups/">Meetups</a></h5>
                                        </div>
                                        <div class="col-md-4 col-sm-12">
                                            <h5 class="text-left"><i class="fa fa-database fa-fw"></i> <a class="link" href="/documentation-archive/v5.0.0-beta.0/documentation-archive/">Archives</a></h5>
                                        </div>
                                    </div>
                                    <div class="footer-col col-md-4">
                                        <ul class="list-inline">
                                            <li>
                                                <a href="https://twitter.com/java_hipster" target="_blank" class="btn-social btn-outline"><i class="fa fa-fw fa-twitter"></i></a>
                                            </li>
                                            <li>
                                                <a href="https://github.com/jhipster/generator-jhipster" target="_blank" class="btn-social btn-outline"><i class="fa fa-fw fa-github"></i></a>
                                            </li>
                                            <li>
                                                <a href="https://gitter.im/jhipster/generator-jhipster" target="_blank" class="btn-social btn-outline"><i class="fa fa-fw fa-comments"></i></a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="footer-below">
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-12">
                                        Copyright &copy; JHipster 2013-2018 | Theme based on <a href="https://github.com/IronSummitMedia/startbootstrap-freelancer" target="_blank">Freelancer</a> and <a href="https://github.com/tui2tone/flat-admin-bootstrap-templates" target="_blank">Flat admin</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
                <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
                <div class="scroll-top page-scroll visible-xs visible-sm">
                    <a class="btn btn-primary" href="#page-top">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                </div>
            </div>
            <!-- /#page-wrapper -->
        </div>
        <!-- /#wrapper -->
    </div>
    <!-- Javascript Libs -->
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/lib/js/jquery.min.js"></script>
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/lib/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/lib/js/ace.js"></script>
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/lib/js/mode-html.js"></script>
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/lib/js/theme-github.js"></script>
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/lib/js/jquery.easing.min.js"></script>

    

    <!--App Javascript -->
    <script type="text/javascript" src="/documentation-archive/v5.0.0-beta.0/js/app.js"></script>
    
    
    
    <!-- JavaScript -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-46075199-1', 'auto');
        ga('send', 'pageview');
    </script>
</body>

</html>
<script>
$(document.body).prepend('<div class="alert alert-danger alert-dismissible fade in" style="z-index: 9999;padding-top: 80px;height: 80;margin:0px;top:0;" role="alert"><h4><i class="fa fa-exclamation-triangle"><\/i> JHipster old documentation<\/h4><p>This documentation is for an older version of JHipster. Click <a href="https://jhipster.github.io/">here</a> for the current version of the documentation.<\/p><\/div>');</script>
